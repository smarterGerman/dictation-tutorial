<!DOCTYPE html>
<!--
    GERMAN DICTATION TOOL - MODULAR VERSION
    
    This is the modern, modular implementation of the German Dictation Tool.
    
    üìÅ Architecture:
    - Clean HTML structure (minimal, semantic)
    - Separate CSS file (css/styles.css)
    - Modular ES6 JavaScript (js/modules/*.js)
    - Configuration-driven (js/config.js)
    
    üöÄ Features:
    - Same functionality as original version
    - Better code organization and maintainability
    - ES6 modules for tree-shaking and performance
    - Easier testing and debugging
    
    üí° Usage:
    - Main application file - use this for development
    - Requires modern browser with ES6 module support
    - Serve via HTTP server (python3 -m http.server 8000)
    
    üìö See README.md for complete documentation
-->
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>German Dictation Tool - Modular Version</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
     <!-- LOADING OVERLAY -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-content">
            <div class="loading-spinner"></div>
            <div class="loading-text" id="loadingText" style="display:none;">Initializing...</div>
            <div class="loading-error" id="loadingError" style="display: none;">
                <div class="error-message" id="errorMessage"></div>
                <button class="retry-btn" id="retryBtn">Try Again</button>
            </div>
        </div>
    </div>
    <div class="container">
        <!-- Tutorial Button -->
        <div class="tutorial-launcher">
            <button class="tutorial-btn-launcher" id="tutorialLauncher" title="Open Tutorial">
                i
            </button>
        </div>
        
        <div class="content">
            <!-- AUDIO SECTION -->
            <div class="audio-section">
                <div class="audio-controls">
                    <div class="player-pill">
                        <button class="nav-btn" id="prevBtn" title="Previous sentence">‚Äπ</button>
                       <button class="play-btn" id="playBtn" title="Play/Pause (double-click to restart)"></button>
                        <button class="nav-btn" id="nextBtn" title="Next sentence">‚Ä∫</button>
                        <button class="toggle-btn" id="ignoreCaseBtn" title="Capitalization checking OFF">Aa</button>
                        <button class="toggle-btn" id="focusModeBtn" title="Focus Mode OFF - Show live feedback">
                            <span class="focus-icon"></span>
                        </button>
                        <button class="toggle-btn" id="speedBtn" title="Playback Speed">100</button>
                    </div>
                    
                    <!-- Progress bar and controls row -->
                    <div class="progress-controls-row">
                        <button class="toggle-btn secondary-btn" id="hintBtn" title="Show expected sentence">?</button>
                        <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
                        <span id="timeDisplay">0:00 / 0:00</span>
                        <button class="toggle-btn secondary-btn" id="endDictationBtn" title="End dictation & show stats">X</button>
                    </div>
                </div>
                <audio id="audioPlayer" preload="auto"></audio>
            </div>

            <!-- TEXT & FEEDBACK -->
            <div class="text-section">
                <!-- Hint display area - only appears when needed -->
                <div class="hint-display" id="hintDisplay" style="display: none;">
                    <div class="hint-content" id="hintContent"></div>
                </div>
                
                <div class="input-area">
                    <div class="live-feedback" id="liveFeedback">Live Feedback</div>
                    <textarea class="input-field" id="userInput" placeholder=""></textarea>
                </div>

                <div class="options">
                    <!-- Options moved to audio controls -->
                </div>

                <div class="reference-text" id="referenceText"></div>
            </div>

            <!-- STATS & CONTROLS -->
            <div class="stats-section">
                <div class="stats-with-export" id="statsSection" style="display:none;">
                    <div class="stats-header">
                        <div class="stats-title">Results</div>
                        <div class="stats-actions">
                            <button class="stats-action-btn restart-btn" id="restartBtn" title="Restart dictation">‚Üª</button>
                            <button class="stats-action-btn export-btn" id="exportCsvBtn" title="Export CSV">CSV</button>
                        </div>
                    </div>
                    <div class="stats">
                        <div class="stat-item"><span class="stat-label">Accuracy</span><span class="stat-value" id="accuracyPercent">0%</span></div>
                        <div class="stat-item"><span class="stat-label">Correct</span><span class="stat-value" id="correctWords">0</span></div>
                        <div class="stat-item"><span class="stat-label">Wrong</span><span class="stat-value" id="wrongWords">0</span></div>
                        <div class="stat-item"><span class="stat-label">Time</span><span class="stat-value" id="timeTaken">0:00</span></div>
                    </div>
                </div>

                <!-- Detailed sentence results -->
                <div class="sentence-results" id="sentenceResults" style="display:none;">
                    <div class="sentences-container" id="sentencesContainer">
                        <!-- Sentences will be inserted here by JavaScript -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Shortcuts Button and Box -->
<button id="show-shortcuts" class="dt-shortcut-btn"
  style="position:fixed;top:24px;right:24px;z-index:9999;background:linear-gradient(90deg,#ffebee 0%,#fff3e0 20%,#fffde7 40%,#e8f5e9 60%,#e3f2fd 80%,#ede7f6 100%);border-radius:8px;padding:0.3em 0.7em;">
  <svg width="22" height="22" viewBox="0 0 22 22" fill="none" style="vertical-align:middle;">
    <circle cx="6" cy="6" r="3.2" stroke="#d32f2f" stroke-width="1.6" fill="#fff"/>
    <circle cx="16" cy="16" r="3.2" stroke="#1976d2" stroke-width="1.6" fill="#fff"/>
    <line x1="7.8" y1="7.8" x2="14.2" y2="14.2" stroke="#888" stroke-width="1.6"/>
    <line x1="7.8" y1="14.2" x2="14.2" y2="7.8" stroke="#888" stroke-width="1.6"/>
  </svg>
</button>
<div class="infobox dt-shortcut-box" id="shortcuts-box"
  style="display:none;position:fixed;top:70px;right:24px;z-index:9999;max-width:340px;">
  <h2>Keyboard Shortcuts</h2>
  <ul class="shortcut-list">
    <li><span class="shortcut-desc">Play/Pause</span><span class="shortcut-key">Shift + Cmd/Ctrl + Enter</span></li>
    <li><span class="shortcut-desc">Back</span><span class="shortcut-key">Shift + Cmd/Ctrl + ‚Üê</span></li>
    <li><span class="shortcut-desc">Forward</span><span class="shortcut-key">Shift + Cmd/Ctrl + ‚Üí</span></li>
    <li><span class="shortcut-desc">Repeat</span><span class="shortcut-key">Shift + Cmd/Ctrl + ‚Üë</span></li>
    <li><span class="shortcut-desc">Change speed</span><span class="shortcut-key">Shift + Cmd/Ctrl + ‚Üì</span></li>
    <li><span class="shortcut-desc">Help</span><span class="shortcut-key">Shift + Cmd/Ctrl + /</span></li>
    <li><span class="shortcut-desc">Submit text</span><span class="shortcut-key">Enter</span></li>
  </ul>
</div>
<script>
const btn = document.getElementById('show-shortcuts');
const box = document.getElementById('shortcuts-box');
btn.addEventListener('click', function() {
  if (box.style.display === 'none') {
    box.style.display = 'block';
    btn.innerHTML = '‚úï';
  } else {
    box.style.display = 'none';
    btn.innerHTML = `<svg width=\"22\" height=\"22\" viewBox=\"0 0 22 22\" fill=\"none\" style=\"vertical-align:middle;\"><circle cx=\"6\" cy=\"6\" r=\"3.2\" stroke=\"#d32f2f\" stroke-width=\"1.6\" fill=\"#fff\"/><circle cx=\"16\" cy=\"16\" r=\"3.2\" stroke=\"#1976d2\" stroke-width=\"1.6\" fill=\"#fff\"/><line x1=\"7.8\" y1=\"7.8\" x2=\"14.2\" y2=\"14.2\" stroke=\"#888\" stroke-width=\"1.6\"/><line x1=\"7.8\" y1=\"14.2\" x2=\"14.2\" y2=\"7.8\" stroke=\"#888\" stroke-width=\"1.6\"/></svg>`;
  }
});
</script>

    <!-- Modular JavaScript -->
    <script type="module" src="js/app.js"></script>
</body>
</html>
